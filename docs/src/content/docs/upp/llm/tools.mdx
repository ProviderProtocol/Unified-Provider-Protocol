---
title: Tools
description: Tool definition, execution, and strategies in UPP.
---

import { Aside, Badge, Card, CardGrid } from '@astrojs/starlight/components';

# Tools

<Badge text="UPP-1.3.0" variant="note" />

## Tool Definition

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | String | Yes | Tool name (unique within instance) |
| `description` | String | Yes | Description for the model |
| `parameters` | JSONSchema | Yes | Parameter schema |
| `run` | Function | Yes | Execution function |
| `approval` | Function | No | Approval handler |
| `metadata` | Map | No | Provider-specific metadata |

## Tool Execution

By default, `llm()` handles tool execution automatically:

1. Model returns `AssistantMessage` with `toolCalls`
2. If `approval` defined and returns `false`, error result sent to model
3. Tool's `run` function executed
4. Result sent back as `ToolResultMessage`
5. Loop continues until no tool calls OR max iterations

**IMPORTANT:** `llm()` SHALL NOT validate tool arguments against the schema. Tool implementations MUST treat arguments as untrusted input.

## ToolUseStrategy

| Field | Type | Description |
|-------|------|-------------|
| `maxIterations` | Integer | Maximum tool rounds (default: 10) |
| `onToolCall` | Function | Called when tool requested |
| `onBeforeCall` | Function | Called before execution |
| `onAfterCall` | Function | Called after execution |
| `onError` | Function | Called on execution error |
| `onMaxIterations` | Function | Called when max reached |

## Provider-Native Tools

Some providers offer built-in server-side tools (web search, code interpreter, etc.). These differ from UPP function tools:

| Aspect | UPP Function Tools | Provider-Native Tools |
|--------|-------------------|----------------------|
| Passed via | `tools` parameter | `params.tools` |
| Execution | Client-side | Server-side |

```
// Provider-native tools go in params
gpt = llm({
  model: openai("gpt-4o"),
  params: {
    tools: [{ type: "web_search" }]
  },
  // UPP function tools
  tools: [myCustomTool]
})
```